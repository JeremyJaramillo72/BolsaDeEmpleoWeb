<div class="layout-container">

  <aside class="sidebar" [class.collapsed]="!isSidebarOpen">

    <div class="sidebar-header">
      <div class="brand-logo">
        <span class="material-icons">shield</span>
      </div>
      <div class="brand-text" *ngIf="isSidebarOpen">
        <h2>Bolsa de Empleo</h2>
        <p>UTEQ</p>
      </div>
    </div>

    <div class="sidebar-profile" *ngIf="isSidebarOpen">
      <div class="sp-avatar">{{ nombreUsuario.charAt(0) | uppercase }}</div>
      <div class="sp-info">
        <span class="sp-name">{{ nombreUsuario }}</span>
        <span class="sp-role">{{ rolUsuario | titlecase }}</span>
      </div>
    </div>

    <button class="collapse-btn" (click)="toggleSidebar()">
      <span class="material-icons">{{ isSidebarOpen ? 'chevron_left' : 'chevron_right' }}</span>
    </button>

    <nav class="sidebar-nav">

      <div class="menu-label" *ngIf="isSidebarOpen">MEN PRINCIPAL</div>

      <a routerLink="/menu-principal"
         [routerLinkActiveOptions]="{exact: true}"
         routerLinkActive="active"
         class="nav-item"
         (click)="dashboardHomeVisible = true">
        <span class="material-icons nav-icon">grid_view</span>
        <span class="nav-text" *ngIf="isSidebarOpen">Inicio</span>
      </a>

      <a *ngFor="let item of menuItems"
         (click)="onMenuItemClick(item)"
         [routerLink]="item.route"
         routerLinkActive="active"
         class="nav-item">

        <span class="material-icons nav-icon" [ngStyle]="{'color': item.colorHex || '#64748b'}">{{ item.icon }}</span>
        <span class="nav-text" *ngIf="isSidebarOpen">{{ item.title }}</span>

        <div class="badge" *ngIf="isSidebarOpen && item.badge">{{ item.badge }}</div>
      </a>
    </nav>

    <div class="sidebar-footer">
      <a (click)="cerrarSesion()" class="nav-item logout">
        <span class="material-icons nav-icon">logout</span>
        <span class="nav-text" *ngIf="isSidebarOpen">Cerrar Sesi贸n</span>
      </a>
    </div>
  </aside>

  <main class="main-content">

    <header class="topbar">
      <div class="topbar-left">
        <h2>Panel de Control</h2>
        <p>Bienvenido al sistema de administraci贸n UTEQ</p>
      </div>

      <div class="topbar-right">
        <button class="icon-btn">
          <span class="material-icons">notifications_none</span>
          <span class="red-dot">3</span>
        </button>

        <div class="user-profile">
          <div class="avatar" *ngIf="!fotoMenu">
            {{ nombreUsuario.charAt(0) | uppercase }}
          </div>
          <img *ngIf="fotoMenu" [src]="fotoMenu" class="avatar-img" alt="Logo">

          <div class="user-info">
            <span class="user-name">{{ nombreUsuario }}</span>
            <span class="user-role">{{ rolUsuario | titlecase }}</span>
          </div>
          <span class="material-icons text-gray">expand_more</span>
        </div>
      </div>
    </header>

    <div class="scroll-area">
      <div class="dashboard-wrapper animate-fade" *ngIf="isDashboardHome()">

        <div class="welcome-header">
          <h1>Bienvenido, <span class="text-primary">{{ nombreUsuario }}</span> </h1>
          <p>Accede r谩pidamente a cualquier m贸dulo del sistema desde aqu铆.</p>
        </div>

        <div class="stats-row">
          <div class="stat-card" *ngFor="let stat of statsCards">
            <div class="stat-icon-wrap" [ngStyle]="{'background-color': (stat.colorHex || '#2563EB') + '15'}">
              <span class="material-icons" [ngStyle]="{'color': stat.colorHex || '#2563EB'}">{{ stat.icon || 'analytics' }}</span>
            </div>
            <div class="stat-data">
              <span class="stat-label">{{ stat.label }}</span>
              <span class="stat-value">{{ stat.value }}</span>
            </div>
          </div>
        </div>

        <div class="modules-grid">
          <div class="module-card" *ngFor="let item of menuItems" (click)="onMenuItemClick(item)">

            <div class="module-badge" *ngIf="item.badge">{{ item.badge }}</div>

            <div class="module-icon-wrap" [ngStyle]="{'background-color': item.bgHex || '#EFF6FF'}">
              <span class="material-icons" [ngStyle]="{'color': item.colorHex || '#2563EB'}">{{ item.icon }}</span>
            </div>

            <h3 class="module-title">{{ item.title }}</h3>
            <p class="module-desc">{{ item.description || 'Administraci贸n de este m贸dulo.' }}</p>

            <div class="module-action" [ngStyle]="{'color': item.colorHex || '#2563EB'}">
              Acceder <span class="material-icons">arrow_forward</span>
            </div>
          </div>
        </div>

      </div>

      <div class="router-wrapper" [class.hidden]="isDashboardHome()">
        <router-outlet></router-outlet>
      </div>

    </div>
  </main>
</div>
